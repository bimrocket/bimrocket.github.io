<!DOCTYPE html>
<html lang="ca">
<head>
  <title>Configuració | BIMROCKET</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="BIMROCKET - The Open BIM Platform">
  <meta name="keywords" content="BIM, THREEJS, OrientDB, MongoDB">
  <meta name="theme-color" content="#404040">
  <link id="hljs-theme" rel="stylesheet" href="">

  <script>
    if (window.localStorage)
    {
      const storedTheme = window.localStorage.getItem("theme");
      if (storedTheme)
      {
        document.documentElement.setAttribute("data-theme", storedTheme);
      }
      const link = document.getElementById('hljs-theme');
      let hljsCss;
      if (storedTheme === "dark")
      {
        hljsCss = "github-dark.min.css";
      }
      else
      {
        hljsCss = "github.min.css";
      }
      link.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/" + hljsCss;
    }
  </script>

  <link rel="stylesheet" href="/assets/css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />
  <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;family=Montserrat:ital,wght@0,100..900;1,100..900&amp;family=Open+Sans:ital,wght@0,300..800;1,300..800&amp;family=Raleway:ital,wght@0,100..900;1,100..900&amp;family=Work+Sans:ital,wght@0,100..900;1,100..900&amp;display=swap" rel="stylesheet" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/yaml.min.js"></script>
</head>
<body>
  <header>
    <a href="/ca"><h1><img src="/assets/img/bimrocket.svg" alt="BIMROCKET" class="logo"></h1></a>

    <select id="lang-select" title="Selector d&#39;idioma">
      <option value="en" data-short="EN" >EN</option>
      <option value="es" data-short="ES" >ES</option>
      <option value="ca" data-short="CA" selected>CA</option>
    </select>

    <button class="image-button menu-toggle" title="menu toggler"><span class="material-symbols-outlined">menu</span></button>
    <button class="image-button theme-toggle" title="theme selector"><span class="material-symbols-outlined">dark_mode</span></button>

    <nav>
      <ul id="menu">
        <li><a href="/ca">Inici</a></li>
        <li class="submenu">
          <a href="#">Producte <span class="material-symbols-outlined">keyboard_arrow_down</span></a>
          <ul>
            <li><a href="/ca/features">Característiques</a></li>
            <li><a href="/ca/architecture">Arquitectura</a></li>
            <li><a href="/ca/license">Llicència</a></li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Documentació <span class="material-symbols-outlined">keyboard_arrow_down</span></a>
          <ul>
            <li><a href="/ca/install">Instal·lació</a></li>
            <li><a href="/ca/configuration">Configuració</a></li>
            <li><a href="/ca/user_guides">Guies d&#39;usuari</a></li>
          </ul>
        </li>
        <li><a href="/ca/download">Baixades</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="content">
      
      <h2><span class="material-symbols-outlined">settings</span> Configuració</h2>
      

      <p>La configuració del servidor <strong>Bimrocket</strong> es gestiona amb la llibreria <a href="https://smallrye.io/smallrye-config">smallrye-config</a>, que segueix l’especificació <a href="https://microprofile.io/specifications/microprofile-config-2/">microprofile-config</a>. Aquesta llibreria pot obtenir paràmetres de configuració de múltiples fonts al mateix temps (variables d'entorn, propietats de la JVM, fitxers externs, etc.).
Per defecte, Bimrocket defineix aquests paràmetres en un fitxer YAML com aquest:</p>
<pre><code class="language-yaml"># bimrocket-server config

# service config
services:

  # security service
  security:
    adminPassword: bimrocket
    passwordPattern: '^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&amp;+=_\-\.])(?=\S+$).{8,}$'
    authorizationCacheTimeout: 300
    userCacheTimeout: 300
    roleCacheTimeout: 300
    ldap:
      enabled: false
      url: ldap://dc1.santfeliu.local
      domain: santfeliu.local
      searchBase: DC=santfeliu,DC=local
      adminUsername: admin
      adminPassword: changeit
    store:
      class: org.bimrocket.service.security.store.orient.SecurityOrientDaoStore
      orient:
        database: bimdb

  # file service
  file:
    store:
      class: org.bimrocket.service.file.store.filesystem.FileSystemFileStore
      filesystem:
        directory: ${BIMROCKET_DATA_PATH}/cloudfs
    folders:
      - models
      - scripts
      - reports
      - ifc_snapshots

  # bcf service
  bcf:
    projectTemplate:
    store:
      class: org.bimrocket.service.bcf.store.orient.BcfOrientDaoStore
      orient:
        database: bimdb
    mail:
      createTopic:
        subject: '#{project.name}##{index}: #{title} [#{priority}]'
        body: '#{description}'

  # ifcdb service
  ifcdb:
    schemas:
      - IFC2X3
      - IFC4
    maxFileSizeMb: 200
    store:
      class: org.bimrocket.service.ifcdb.store.orient.OrientIfcStore

  # task service
  task:
    taskCacheSize: 10
    store:
      class: org.bimrocket.service.task.store.orient.TaskOrientDaoStore
      orient:
        database: bimdb

  # print service
  print:
    directory: ${BIMROCKET_DATA_PATH}/printsvc
    title: 'Bimrocket print'
    creator: 'Bimrocket PrintService'

  # mail service
  mail:
    enabled: false
    host: helios
    port: 25
    startTls: false
    auth: false
    username: none
    password: none
    from: 'admin@bimrocket.org'
    contentType: 'text/plain;charset=ISO-8859-1'

  # proxy service
  proxy:
    validUrls:
      - https://api.openai.com/
      - https://api.bsdd.buildingsmart.org/
    aliases:
      chatgpt:
        url: https://api.openai.com/v1/chat/completions
        ipFilter: ''
        authorization: changeit

# database config
databases:
  bimdb:
    url: embedded:${BIMROCKET_DATA_PATH}/db/bimdb
    username: root
    password: orientdb
  IFC2X3:
    url: embedded:${BIMROCKET_DATA_PATH}/db/IFC2X3
    username: root
    password: orientdb
  IFC4:
    url: embedded:${BIMROCKET_DATA_PATH}/db/IFC4
    username: root
    password: orientdb

</code></pre>
<p>Durant l’inici del servidor, es crea (si no existeix) un fitxer de configuració YAML en aquesta ruta: <code>${BIMROCKET_DATA_PATH}/bimrocket-server.yaml</code>, on <code>${BIMROCKET_DATA_PATH}</code> apunta per defecte a <code>${user.home}/bimrocket</code>.
Edita aquest fitxer YAML per canviar els paràmetres que necessitis i reinicia el servidor Bimrocket perquè els canvis tinguin efecte.</p>
<p>El valor de <code>BIMROCKET_DATA_PATH</code> es pot modificar mitjançant una variable d'entorn o una propietat de la JVM:</p>
<ul>
<li><strong>Variable d'entorn:</strong> <code>BIMROCKET_DATA_PATH=&lt;la_meva_ubicació&gt;</code></li>
<li><strong>Propietat JVM:</strong> en instal·lacions de Tomcat, edita <code>&lt;TOMCAT_HOME&gt;/conf/catalina.properties</code> i afegeix aquesta línia: <code>BIMROCKET_DATA_PATH=&lt;la_meva_ubicació&gt;</code></li>
</ul>
<p>En la configuració per defecte, <strong>Bimrocket</strong> crea automàticament bases de dades incrustades d’<strong>OrientDB</strong> en la ruta <code>${BIMROCKET_DATA_PATH}/db</code>.
Pots canviar les URL de les bases de dades al fitxer <code>bimrocket-server.yaml</code> per crear-les en un servidor remot d’OrientDB.</p>
<p>La contrasenya per defecte de l’usuari <code>admin</code> és <code>bimrocket</code>.
Aquesta es pot canviar mitjançant la propietat <code>services.security.adminPassword</code> del fitxer <code>bimrocket-server.yaml</code>.</p>
<h3>Paràmetres de configuració dels serveis</h3>
<p>A continuació es descriuen els paràmetres de configuració que accepta cada servei.<br>
Aquests paràmetres es poden modificar directament al fitxer <code>bimrocket-server.yaml</code> o bé mitjançant qualsevol altre mecanisme previst per la
llibreria <em>smallrye config</em> (propietats d’entorn, variables de la JVM, etc.).<br>
En molts casos, és necessari reiniciar els serveis perquè els canvis de configuració tinguin efecte.</p>
<h4>SecurityService</h4>
<p>Servei que gestiona la informació dels usuaris i els rols d’accés.<br>
Ruta base: <code>services.security</code></p>
<ul>
<li><code>.adminPassword</code> {String}: Contrasenya de l’usuari <code>admin</code>. Aquest usuari té privilegis totals sobre tots els serveis.</li>
<li><code>.passwordPattern</code> {String}: Expressió regular de Java que determina el format acceptat de les contrasenyes dels usuaris.</li>
<li><code>.authorizationCacheTimeout</code> {Long}: Temps de refresc (en segons) de la memòria cau d’autorització.</li>
<li><code>.userCacheTimeout</code> {Long}: Temps de refresc (en segons) de la memòria cau d’usuaris.</li>
<li><code>.roleCacheTimeout</code> {Long}: Temps de refresc (en segons) de la memòria cau de rols.</li>
<li><code>.ldap.enabled</code> {Boolean}: Paràmetre que indica si les contrasenyes dels usuaris es validen contra un servidor LDAP.<br>
Quan aquest paràmetre està activat, no és necessari que els usuaris es creïn a la base de dades.</li>
<li><code>.ldap.url</code> {String}: URL del servidor LDAP.</li>
<li><code>.ldap.domain</code> {String}: Domini del servidor LDAP.</li>
<li><code>.ldap.searchBase</code> {String}: Ruta base del directori LDAP on es busquen els usuaris.</li>
<li><code>.ldap.adminUsername</code> {String}: Usuari per accedir al servidor LDAP.</li>
<li><code>.ldap.adminPassword</code> {String}: Contrasenya per accedir al servidor LDAP.</li>
<li><code>.store.class</code> {Class}: Classe que implementa l’emmagatzematge dels usuaris i rols:
<ul>
<li>Per a l’emmagatzematge a OrientDB: <code>org.bimrocket.service.security.store.orient.SecurityOrientDaoStore</code></li>
<li>Per a l’emmagatzematge a MongoDB: <code>org.bimrocket.service.security.store.mongo.SecurityMongoDaoStore</code></li>
</ul>
</li>
<li><code>.store.orient.database</code> {String}: Àlies de la base de dades OrientDB que es defineix a la secció <code>databases</code>.</li>
<li><code>.store.mongo.database</code> {String}: Àlies de la base de dades MongoDB que es defineix a la secció <code>databases</code>.</li>
</ul>
<h4>FileService</h4>
<p>Servei que gestiona l’emmagatzematge de fitxers i carpetes.<br>
Ruta base: <code>services.file</code></p>
<ul>
<li><code>.folders</code> {List&lt;String&gt;}: Llista de carpetes a crear al directori base del servei.</li>
<li><code>.store</code> {Class}: Classe que implementa l’emmagatzematge de carpetes i fitxers:
<ul>
<li>Per a l’emmagatzematge al sistema de fitxers: <code>org.bimrocket.service.file.store.filesystem.FileSystemFileStore</code></li>
</ul>
</li>
<li><code>.store.filesystem.directory</code> {String}: Directori base on s’emmagatzemen les carpetes i els fitxers.</li>
</ul>
<h4>BcfService</h4>
<p>Servei que gestiona l’emmagatzematge d’incidències BCF.<br>
Ruta base: <code>services.bcf</code></p>
<ul>
<li><code>.projectTemplate</code> {String}: Nom del projecte que es pren com a plantilla.<br>
En crear un nou projecte BCF, aquest heretarà les extensions (<em>BcfExtensions</em>) del projecte plantilla.</li>
<li><code>.store</code> {Class}: Classe que implementa l’emmagatzematge de les incidències BCF:
<ul>
<li>Per a l’emmagatzematge a OrientDB: <code>org.bimrocket.service.bcf.store.orient.BcfOrientDaoStore</code></li>
<li>Per a l’emmagatzematge a MongoDB: <code>org.bimrocket.service.bcf.store.mongo.BcfMongoDaoStore</code></li>
</ul>
</li>
<li><code>.store.orient.database</code>: Àlies de la base de dades OrientDB que es defineix a la secció <code>databases</code>.</li>
<li><code>.store.mongo.database</code>: Àlies de la base de dades MongoDB que es defineix a la secció <code>databases</code>.</li>
<li><code>.mail.createTopic.subject</code> {String}: Patró que determina l’assumpte del missatge que s’enviarà als participants
de la incidència en el moment de la seva creació. El patró pot incloure expressions <code>#{&lt;property&gt;}</code> on <code>property</code> és qualsevol propietat del <em>Topic</em> (incidència).</li>
<li><code>.mail.createTopic.body</code> {String}: Patró que determina el cos del missatge que s’enviarà als
participants de la incidència en el moment de la seva creació. El patró pot incloure expressions <code>#{&lt;property&gt;}</code> on <code>property</code> és qualsevol propietat del <em>Topic</em> (incidència).</li>
</ul>
<h4>IfcdbService</h4>
<p>Servei que gestiona l’emmagatzematge d’objectes d’un model IFC en una base de dades.<br>
Ruta base: <code>services.ifcdb</code></p>
<ul>
<li><code>.schemas</code> {List&lt;String&gt;}: Llista d’esquemes IFC suportats (IFC2X3, IFC4 o IFC4X3_ADD2).<br>
Per a cada esquema es crearà una base de dades diferent.<br>
L’<code>àlies</code> de la base de dades utilitzada coincidirà amb el nom de l’esquema IFC.</li>
<li><code>.maxFileSizeMb</code> {Integer}: Mida màxima en MB dels models IFC que es poden emmagatzemar a la base de dades.</li>
<li><code>.store</code> {Class}: Classe que determina la implementació de l’emmagatzematge dels models:
<ul>
<li>Per a l’emmagatzematge a OrientDB: <code>org.bimrocket.service.ifcdb.store.orient.OrientIfcStore</code></li>
<li>Per a l’emmagatzematge a MongoDB: <code>org.bimrocket.service.ifcdb.store.mongo.MongoIfcStore</code></li>
</ul>
</li>
</ul>
<h4>TaskService</h4>
<p>Servei que gestiona l’execució de tasques al servidor.<br>
Ruta base: <code>services.task</code></p>
<ul>
<li><code>.taskCacheSize</code> {Integer}: Nombre de tasques que es desen en memòria cau amb una estructura LRU.</li>
<li><code>.store.class</code> {Class}: Classe que determina la implementació de l’emmagatzematge de les dades de les tasques:
<ul>
<li>Per a l’emmagatzematge a OrientDB: <code>org.bimrocket.service.task.store.orient.TaskOrientDaoStore</code></li>
<li>Per a l’emmagatzematge a MongoDB: <code>org.bimrocket.service.task.store.mongo.TaskMongoDaoStore</code></li>
</ul>
</li>
<li><code>.store.orient.database</code> {String}: Àlies de la base de dades OrientDB que es defineix a la secció <code>databases</code>.</li>
<li><code>.store.mongo.database</code> {String}: Àlies de la base de dades MongoDB que es defineix a la secció <code>databases</code>.</li>
</ul>
<h4>ProxyService</h4>
<p>Servei per accedir a URL externes.<br>
Ruta base: <code>services.proxy</code></p>
<ul>
<li><code>.validUrls</code> {List&lt;String&gt;}: Llista de les URLs acceptades pel servidor <em>proxy</em>.</li>
<li><code>.aliases.&lt;alias&gt;</code> {Object}: Definició d’una connexió externa associada a <code>alias</code>.</li>
<li><code>.aliases.&lt;alias&gt;.url</code> {String}: URL externa a la qual es vol accedir.</li>
<li><code>.aliases.&lt;alias&gt;.ipFilter</code> {String}: Expressió regular de Java que determina quines adreces IP poden accedir a la URL.</li>
<li><code>.aliases.&lt;alias&gt;.authorization</code> {String}: Capçalera HTTP <em>Authorization</em> que s’enviarà en accedir a la URL (Bearer o Basic).</li>
</ul>
<h4>MailService</h4>
<p>Servei per enviar correus electrònics.<br>
Ruta base: <code>services.mail</code></p>
<ul>
<li><code>.enabled</code> {Boolean}: Paràmetre que controla l’activació del servei.</li>
<li><code>.host</code> {String}: Nom del servidor de correu SMTP.</li>
<li><code>.port</code> {Integer}: Port d’escolta del servidor de correu.</li>
<li><code>.startTls</code> {Boolean}: Paràmetre que controla l’ús del protocol TLS.</li>
<li><code>.auth</code> {Boolean}: Paràmetre que indica si la connexió s’estableix passant credencials.</li>
<li><code>.username</code> {String}: Nom de l’usuari que s’autentica al servidor.</li>
<li><code>.password</code> {String}: Contrasenya de l’usuari que s’autentica al servidor.</li>
<li><code>.from</code> {String}: Adreça de correu del remitent per defecte.</li>
<li><code>.contentType</code> {String}: <em>Content-Type</em> del cos del missatge.</li>
</ul>
<h4>PrintService</h4>
<p>Servei per generar fitxers PDF amb geometries vectorials.<br>
Ruta base: <code>services.print</code></p>
<ul>
<li><code>.directory</code> {String}: Directori on s’emmagatzemen els fitxers PDF generats.</li>
<li><code>.title</code> {String}: Títol que es mostrarà al document PDF.</li>
<li><code>.creator</code> {String}: Propietat <code>creator</code> que s’incorporarà al document PDF.</li>
</ul>

    </div>
  </main>

  <footer>
    <p><a href="/ca">© 2025 BIMROCKET</a></p>
    <a href="https://github.com/bimrocket/bimrocket" class="github"><img src="/assets/img/github.svg" alt="github" /> GitHub</a>
  </footer>

  <button id="up-button" title="Anar amunt">
    <span class="material-symbols-outlined">arrow_upward</span>
  </button>

  <script src="/assets/js/main.js">
  </script>

  <script>hljs.highlightAll();</script>

</body>
</html>